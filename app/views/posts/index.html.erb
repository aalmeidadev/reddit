<p id="notice"><%= notice %></p>

<h1>Posts</h1>

<table>
  <thead>
  </thead>

  <tbody>
    <% @posts.each do |post| %>
      <tr>
        <td><%= post.downvote %></td>
        <td><button class="downvote" data-id=<%="#{post.id}"%>>&#8249;</button></td>
        <td><%= post.contents %></td>
        <td><button class="upvote" data-id=<%="#{post.id}"%>>&#8250;</button></td>
        <td><%= post.upvote %></td>

        <td><%= link_to 'Mostrar', post %></td>
        <td><%= link_to 'Excluir', post, method: :delete, data: { confirm: 'Tem certeza?' } %></td>
      </tr>
    <% end %>
  </tbody>
</table>

<br>

<%= link_to 'New Post', new_post_path %>

<script>
$(document).ready(function() {

  $(".upvote").click(function( event ) {

    var id = (this.dataset['id']);
    const data = {upvote: '+1'};


//POST request with body equal on data in JSON format
fetch('http://localhost:3000/votes/'+id+'.json', {
  method: 'put',
  headers: {
    'Content-Type': 'application/json',
  },
  body: JSON.stringify(data),
})
.then((response) => response.json())
//Then with the data from the response in JSON...
.then((data) => {
  console.log('Success:', data);
})
//Then with the error genereted...
.catch((error) => {
  console.error('Error:', error);
});

//																		Yeah
    });


  $(".downvote").click(function( event ) {

    var id = (this.dataset['id']);

    var id = (this.dataset['id']);
    const data = {downvote: '-1'};


//POST request with body equal on data in JSON format
fetch('http://localhost:3000/votes/'+id+'.json', {
  method: 'put',
  headers: {
    'Content-Type': 'application/json',
  },
  body: JSON.stringify(data),
})
.then((response) => response.json())
//Then with the data from the response in JSON...
.then((data) => {
  console.log('Success:', data);
})
//Then with the error genereted...
.catch((error) => {
  console.error('Error:', error);
});

//																		Yeah
    });
});

</script>
